Category:
  id: serial32
  name: text8(1, null) @collate(general)
  farm: ?farm\Farm
  position: int8(0, null)
  createdAt: datetime = SPECIAL(now)
  INDEX: [
    ["farm"]
  ]
  
Customer:
  id: serial32
  name: ?text8(1, 50) @collate(general)
  firstName: ?text8(1, 30) @collate(general)
  lastName: ?text8(1, 30) @collate(general)
  commercialName: ?text8
  legalName: ?text8
  document: ?int32(1, null)
  number: ?text8
  email: ?email
  phone: ?text8
  contactName: ?text8
  farm: farm\Farm
  user: ?user\User
  groups: json = PHP([])
  type: enum(PRIVATE, PRO)
  destination: ?enum(INDIVIDUAL, COLLECTIVE)
  discount: int8(0, 100) = 0
  orderFormEmail: ?email
  deliveryNoteEmail: ?email
  invoiceEmail: ?email
  invoiceStreet1: ?text8
  invoiceStreet2: ?text8
  invoicePostcode: ?text8
  invoiceCity: ?text8
  invoiceCountry: ?user\Country
  siret: ?text8(1, null)
  vatNumber: ?text8
  deliveryStreet1: ?text8
  deliveryStreet2: ?text8
  deliveryPostcode: ?text8
  deliveryCity: ?text8
  deliveryCountry: ?user\Country
  defaultPaymentMethod: ?payment\Method
  color: ?color
  createdAt: datetime = SPECIAL(now)
  status: enum(ACTIVE, INACTIVE) = ACTIVE
  INDEX: [
    ["farm", "email"]
  ]
  UNIQUE: [
    ["farm", "user"],
    ["farm", "number"]
  ]

CustomerGroup:
  id: serial32
  name: text8(1, null) @collate(general)
  type: enum(PRIVATE, PRO)
  color: color = PHP('#373737')
  farm: ?farm\Farm
  createdAt: datetime = SPECIAL(now)
  UNIQUE: [
    ["farm", "name"],
  ]

Event:
  id: serial32
  name: text8(1, null) @collate(general)
  fqn: fqn
  color: color = PHP('#AAAAAA')
  UNIQUE: [
    ["fqn"]
  ]

Grid:
  id: serial32
  farm: farm\Farm
  customer: ?selling\Customer
  group: ?selling\CustomerGroup
  product: selling\Product
  price: decimal(10, 4, 0.0, null)
  priceInitial: ?decimal(10, 4, 0.0, null)
  createdAt: datetime = SPECIAL(now)
  updatedAt: datetime = SPECIAL(now)
  INDEX: [
    ["product"]
  ]
  UNIQUE: [
    ["customer", "product"],
    ["group", "product"]
  ]

History:
  id: serial32
  sale: selling\Sale
  farm: farm\Farm
  event: selling\Event
  payment: ?selling\Payment
  comment: ?text24
  date: datetime = SPECIAL(now)
  user: ?user\User = SPECIAL(user)
  INDEX: [
    ["sale"]
  ]
  
Invoice:
  id: serial32
  document: ?int32(1, null)
  number: ?text8
  customer: selling\Customer
  sales: json
  taxes: enum(INCLUDING, EXCLUDING)
  nature: ?enum(GOOD, SERVICE, MIXED)
  organic: bool
  conversion: bool
  comment: ?text16
  content: ?selling\PdfContent
  farm: farm\Farm
  hasVat: bool
  vatByRate: ?json
  vat: decimal(8, 2)
  priceExcludingVat: decimal(8, 2)
  priceIncludingVat: decimal(8, 2)
  date: date
  dueDate: ?date
  paymentStatus: ?enum(PAID, PARTIAL_PAID, NOT_PAID, NEVER_PAID, FAILED)
  paymentAmount: ?decimal(8, 2)
  paymentCondition: ?editor16(1, 400)
  header: ?editor16(1, 400)
  footer: ?editor16(1, 400)
  status: enum(DRAFT, CONFIRMED, GENERATED, DELIVERED, CANCELED)
  statusCash: enum(WAITING, DRAFT, VALID, IGNORED) = WAITING
  generation: ?enum(WAITING, NOW, PROCESSING, FAIL, SUCCESS)
  generationAt: ?datetime
  closed: bool = FALSE
  closedAt: ?datetime
  closedBy: ?user\User
  cashflow: ?bank\Cashflow
  accountingHash: ?textFixed(20, 20) @charset(ascii)
  accountingDifference: ?enum(AUTOMATIC, NOTHING)
  readyForAccounting: ?bool = FALSE
  emailedAt: ?datetime
  paidAt: ?date
  remindedAt: ?date
  createdAt: datetime = SPECIAL(now)
  INDEX: [
    ["farm", "customer"],
  ]
  UNIQUE: [
    ["farm", "number"],
  ]

Item:
  id: serial32
  name: text8(1, null) @collate(general)
  reference: ?text8(1, null) @charset(ascii)
  sale: selling\Sale
  customer: ?selling\Customer
  type: enum(PRIVATE, PRO)
  profile: enum(SALE, SALE_MARKET, MARKET, COMPOSITION) = SALE
  additional: ?text8
  origin: ?text8(1, null)
  farm: farm\Farm
  shop: ?shop\Shop
  shopDate: ?shop\Date
  shopProduct: ?shop\Product
  product: ?selling\Product
  composition: ?selling\Sale
  ingredientOf: ?selling\Item
  nature: enum(GOOD, SERVICE) = GOOD
  quality: enum(NO, ORGANIC, NATURE_PROGRES, CONVERSION)
  parent: ?selling\Item
  packaging: ?decimal(6, 2, 0.01, null)
  unit: ?selling\Unit
  unitPrice: decimal(10, 4)
  unitPriceInitial: ?decimal(10, 4)
  discount: int8(0, 100) = 0
  number: ?decimal(8, 2)
  price: ?decimal(8, 2)
  priceStats: ?decimal(8, 2)
  locked: enum(UNIT_PRICE, NUMBER, PRICE) = PRICE
  vatRate: ?decimal(4, 2, 0.0, 100)
  stats: bool = TRUE
  prepared: bool = FALSE
  account: ?account\Account
  status: enum(PHP(Sale::model()->getPropertyEnum('preparationStatus')))
  createdAt: datetime = SPECIAL(now)
  deliveredAt: date
  INDEX: [
    ["farm", "customer"],
    ["farm", "deliveredAt"],
    ["product"],
    ["sale"],
    ["ingredientOf"],
    ["parent"]
  ]

Payment:
  id: serial32
  source: enum(SALE, INVOICE)
  sale: ?selling\Sale
  invoice: ?selling\Invoice
  customer: ?selling\Customer
  farm: farm\Farm
  amountIncludingVat: ?decimal(8, 2)
  method: payment\Method
  methodName: text8
  onlineCheckoutId: ?text8
  onlinePaymentIntentId: ?text8
  status: enum(NOT_PAID, PAID, FAILED)
  statusCash: enum(WAITING, DRAFT, VALID, IGNORED) = WAITING
  paidAt: ?date
  accountingHash: ?textFixed(20, 20) @charset(ascii)
  createdAt: datetime = SPECIAL(now)
  closed: bool = FALSE
  closedAt: ?datetime
  INDEX: [
    ["farm"],
    ["sale"],
    ["invoice"],
  ]
  UNIQUE: [
    ["onlineCheckoutId"],
    ["onlinePaymentIntentId"]
  ]

Pdf:
  id: serial32
  sale: selling\Sale
  name: text8(1, null)
  used: int16(0, null) = 1
  farm: farm\Farm
  content: ?selling\PdfContent
  crc32: ?int32(0, null)
  type: enum(DELIVERY_NOTE, ORDER_FORM, INVOICE)
  version: ?int16(0, null)
  emailedAt: ?datetime
  createdAt: datetime = SPECIAL(now)
  INDEX: [
    ["sale", "type"],
    ["content"]
  ]
  
PdfContent:
  id: serial32
  hash: ?textFixed(20, 20) @charset(ascii)
  createdAt: datetime = SPECIAL(now)

Product:
  id: serial32
  name: text8(1, null) @collate(general)
  additional: ?text8(1, null) @collate(general)
  description: ?editor24
  vignette: ?textFixed(30, 30) @charset(ascii)
  profile: enum(COMPOSITION, UNPROCESSED_PLANT, UNPROCESSED_ANIMAL, PROCESSED_FOOD, PROCESSED_PRODUCT, OTHER, SERVICE)
  category: ?selling\Category
  reference: ?text8(1, null) @charset(ascii)
  unprocessedPlant: ?plant\Plant
  unprocessedVariety: ?text8(1, null) @collate(general)
  mixedFrozen: ?bool
  processedPackaging: ?text8(1, null)
  processedAllergen: ?text8(1, null)
  processedComposition: ?text16(1, null)
  compositionVisibility: ?enum(PUBLIC, PRIVATE)
  origin: ?text8(1, null) @collate(general)
  farm: farm\Farm
  unit: ?selling\Unit = PHP(\selling\SellingSetting::UNIT_DEFAULT_ID)
  private: bool = TRUE
  privatePrice: ?decimal(10, 4)
  privatePriceInitial: ?decimal(10, 4)
  privateStep: ?decimal(6, 2, 0.01, null)
  pro: bool = TRUE
  proPrice: ?decimal(10, 4)
  proPriceInitial: ?decimal(10, 4)
  proPackaging: ?float32(0.01, null)
  proStep: ?decimal(6, 2, 0.01, null)
  vat: int16(1, null)
  quality: enum(NO, ORGANIC, NATURE_PROGRES, CONVERSION)
  stock: ?decimal(8, 2, 0.0, null)
  stockLast: ?selling\Stock
  stockUpdatedAt: ?datetime
  createdAt: datetime = SPECIAL(now)
  privateAccount: ?account\Account
  proAccount: ?account\Account
  status: enum(ACTIVE, INACTIVE, DELETED) = ACTIVE
  INDEX: [
    ["farm"],
    ["unprocessedPlant"]
  ]
  UNIQUE: [
    ["farm", "reference"]
  ]
  SEARCH: [
    ["name", "origin", "unprocessedVariety"]
  ]

Sale:
  id: serial32
  document: ?int32(1, null)
  farm: farm\Farm
  customer: ?selling\Customer
  profile: enum(SALE, SALE_MARKET, MARKET, COMPOSITION) = SALE
  taxes: enum(INCLUDING, EXCLUDING)
  organic: bool = FALSE
  conversion: bool = FALSE
  nature: ?enum(GOOD, SERVICE, MIXED)
  type: enum(PRIVATE, PRO)
  discount: int8(0, 100) = 0
  items: int16(0, null) = 0
  hasVat: bool
  vat: ?decimal(8, 2)
  vatByRate: ?json
  priceGross: ?decimal(8, 2)
  priceExcludingVat: ?decimal(8, 2)
  priceIncludingVat: ?decimal(8, 2)
  shippingVatRate: ?decimal(4, 2)
  shippingVatFixed: bool = FALSE
  shipping: ?decimal(8, 2, 0.01, null)
  shippingExcludingVat: ?decimal(8, 2)
  secured: bool = FALSE
  securedAt: ?datetime
  closed: bool = FALSE
  closedAt: ?datetime
  closedBy: ?user\User
  preparationStatus: enum(COMPOSITION, DRAFT, BASKET, CONFIRMED, SELLING, PREPARED, DELIVERED, CANCELED, EXPIRED) = DRAFT
  paymentStatus: ?enum(NOT_PAID, PARTIAL_PAID, PAID, NEVER_PAID, FAILED)
  paymentAmount: ?decimal(8, 2)
  compositionOf: ?selling\Product
  compositionEndAt: ?date
  marketSales: ?int(0, null)
  marketParent: ?selling\Sale
  orderFormValidUntil: ?date
  orderFormPaymentCondition: ?editor16(1, 500)
  orderFormHeader: ?editor16(1, 500)
  orderFormFooter: ?editor16(1, 500)
  deliveryNoteDate: ?date
  deliveryNoteHeader: ?editor16(1, 500)
  deliveryNoteFooter: ?editor16(1, 500)
  invoice: ?selling\Invoice
  shop: ?shop\Shop
  shopDate: ?shop\Date
  shopLocked: bool = FALSE
  shopShared: bool = FALSE
  shopUpdated: bool = FALSE
  shopPoint: ?shop\Point
  shopComment: ?text8(1, 150)
  deliveryStreet1: ?text8
  deliveryStreet2: ?text8
  deliveryPostcode: ?text8
  deliveryCity: ?text8
  deliveryCountry: ?user\Country
  comment: ?text24
  stats: bool = TRUE
  crc32: ?int32(0, null)
  createdAt: datetime = SPECIAL(now)
  createdBy: ?user\User = SPECIAL(user)
  deliveredAt: date
  paidAt: ?date
  expiresAt: ?datetime
  statusAt: datetime = SPECIAL(now)
  statusBy: ?user\User = SPECIAL(user)
  accountingHash: ?textFixed(20, 20) @charset(ascii)
  INDEX: [
    ["customer"],
    ["shopDate"],
    ["shop"]
  ]
  UNIQUE: [
    ["compositionOf", "deliveredAt"],
    ["farm", "document"],
  ]

Stock:
  id: serial32
  product: selling\Product
  farm: farm\Farm
  newValue: decimal(8, 2, 0.0, null)
  delta: decimal(8, 2, 0.0, null)
  comment: ?text8(1, null)
  createdAt: datetime = SPECIAL(now)
  createdBy: ?user\User = SPECIAL(user)
  INDEX: [
    ["product"]
  ]

StockBookmark:
  id: serial32
  farm: farm\Farm
  product: selling\Product
  plant: plant\Plant
  unit: enum(KG, UNIT, BUNCH)
  variety: ?plant\Variety
  createdAt: datetime = SPECIAL(now)
  createdBy: ?user\User = SPECIAL(user)
  INDEX: [
    ["farm", "product"],
    ["plant", "unit", "variety"]
  ]
  
Unit:
  id: serial32
  singular: text8(1, 15) @collate(general)
  plural: text8(1, 15) @collate(general)
  short: text8(1, 8) @collate(general)
  farm: ?farm\Farm
  fqn: ?fqn
  approximate: bool = false
  type: enum(INTEGER, DECIMAL)
  UNIQUE: [
    ["farm", "singular"]
  ]
