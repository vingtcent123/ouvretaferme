# Classes de compte
Account:
  id: serial32
  class: text8(1, null)
  description: text8(1, null) @collate(general)
  # Utilisé si le compte a été modifié récemment
  oldDescription: ?text8(1, null) @collate(general)
  visible: bool = TRUE
  custom: bool = FALSE
  journalCode: ?journal\JournalCode
  vatAccount: ?account\Account
  vatRate: ?decimal(5, 2)
  thirdParty: ?account\ThirdParty
  status: enum(ACTIVE, INACTIVE, DELETED) = ACTIVE
  createdAt: datetime = SPECIAL(now)
  createdBy: user\User = SPECIAL(user)
  INDEX: [
      ["id"],
      ["class"]
  ]
  SEARCH: [
    ["description"]
  ]

# Exercices comptables
FinancialYear:
  id: serial32
  startDate: date
  endDate: date
  status: enum(OPEN, CLOSE) = OPEN
  taxSystem: enum(MICRO_BA, BA_REEL_SIMPLIFIE, BA_REEL_NORMAL)
  accountingType: enum(CASH, ACCRUAL)
  legalCategory: int16(1000, 9999) # Catégorie juridique (au sens INSEE) sur 4 chiffres
  accountingMode: enum(ACCOUNTING, CASH_RECEIPTS)
  associates: ?int8(0, null) # Nombre d'associés
  openDate: ?date # Quand le bilan d'ouverture a été réalisé
  closeDate: ?date # Quand le bilan de clôture a été réalisé
  createdAt: datetime = SPECIAL(now)
  createdBy: user\User = SPECIAL(user)

FinancialYearDocument:
  financialYear: account\FinancialYear
  type: text8
  generation: ?enum(WAITING, NOW, PROCESSING, FAIL, SUCCESS)
  generationAt: ?datetime
  content: ?account\PdfContent
  createdAt: datetime = SPECIAL(now)
  UNIQUE: [
    ["financialYear", "type"]
  ]

Import:
  id: serial32
  financialYear: account\FinancialYear
  filename: text8
  status: enum(CREATED, WAITING, IN_PROGRESS, FEEDBACK_REQUESTED, FEEDBACK_TO_TREAT, DONE, CANCELLED) = CREATED
  financialYearStatus: enum(OPEN, CLOSED) = OPEN
  errors: ?set(DATES)
  delimiter: ?textFixed(1,1)
  content: text32
  rules: json = PHP([])
  createdAt: datetime = SPECIAL(now)
  updatedAt: datetime = SPECIAL(now)
  createdBy: user\User = SPECIAL(user)

Log:
  action: text8
  element: text8
  params: ?json = PHP([])
  doneBy: ?user\User = SPECIAL(user)
  createdAt: datetime = SPECIAL(now)

Partner:
  partner: enum(PHP(PartnerSetting::$PARTNERS))
  identifier: ?int(0, null)
  accessToken: text16
  refreshToken: text16
  params: ?json = PHP([])
  synchronizedAt: ?datetime
  synchronization: enum(WAITING, IN_PROGRESS, DONE, FAIL) = WAITING
  createdAt: datetime = SQL(NOW())
  updatedAt: datetime = SQL(NOW())
  expiresAt: ?datetime
  createdBy: user\User = SPECIAL(user)
  updatedBy: user\User = SPECIAL(user)
  UNIQUE: [
    ["partner"]
  ]

Pdf:
  id: serial32
  financialYear: account\FinancialYear
  name: text8(1, null)
  used: int16(0, null) = 1
  content: ?account\PdfContent
  crc32: ?int32(0, null)
  type: text8
  version: ?int16(0, null)
  createdAt: datetime = SPECIAL(now)
  INDEX: [
    ["financialYear", "type"],
    ["content"]
  ]

PdfContent:
  id: serial32
  hash: ?textFixed(20, 20) @charset(ascii)
  createdAt: datetime = SPECIAL(now)

ThirdParty:
  id: serial32
  name: text8(1, null) @collate(general)
  siret: ?text8(1, null)
  vatNumber: ?text8
  customer: ?selling\Customer
  memos: ?json = PHP([])
  normalizedName: ?json = PHP([])
  UNIQUE: [
    ["name"],
  ]
